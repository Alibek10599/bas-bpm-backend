# Документация Notifications Service API

## Доступ к Swagger UI

Swagger UI доступен по адресу: `http://localhost:3007/docs`

## Основные операции

### 1. Управление уведомлениями

#### Отправка уведомления
- Endpoint: `POST /notifications/send`
- Отправляет уведомление одному или нескольким пользователям
- Поддерживает различные типы уведомлений (email, in-app, push)

#### Получение уведомлений пользователя
- Endpoint: `GET /notifications`
- Возвращает список уведомлений текущего пользователя
- Поддерживает пагинацию и фильтрацию

#### Маркировка уведомления как прочитанного
- Endpoint: `PUT /notifications/{id}/mark-as-read`
- Отмечает уведомление как прочитанное

### 2. Управление шаблонами

#### Создание шаблона
- Endpoint: `POST /notifications/templates`
- Создает новый шаблон уведомления
- Поддерживает HTML и текстовый формат

#### Получение шаблона
- Endpoint: `GET /notifications/templates/{code}`
- Возвращает шаблон по его коду

## Примеры использования

1. **Отправка уведомления**:
   ```json
   {
     "recipients": ["user-id-1", "user-id-2"],
     "type": "TASK_ASSIGNED",
     "data": {
       "taskId": "task-123",
       "taskTitle": "Новая задача"
     }
   }
   ```

2. **Создание шаблона**:
   ```json
   {
     "code": "task-assigned",
     "subject": "Вам назначена новая задача",
     "template": "Здравствуйте, {{userName}}! Вам назначена задача: {{taskTitle}}",
     "type": "EMAIL"
   }
   ```

## Фильтрация уведомлений

Доступные параметры фильтрации:
- `status`: Статус уведомления (READ, UNREAD)
- `type`: Тип уведомления (TASK, DOCUMENT, SYSTEM)
- `from`: Дата начала периода
- `to`: Дата конца периода
- `page`: Номер страницы
- `size`: Размер страницы

## Коды ответов

- 200: Успешное получение данных
- 201: Уведомление успешно отправлено
- 400: Ошибка валидации
- 404: Уведомление/шаблон не найден
- 500: Ошибка отправки уведомления

## Модели данных

### NotificationDto
```typescript
{
  id: string;           // ID уведомления
  type: string;         // Тип уведомления
  recipientId: string;  // ID получателя
  status: string;       // Статус (READ/UNREAD)
  title: string;        // Заголовок
  content: string;      // Содержание
  data: object;         // Дополнительные данные
  createdAt: Date;      // Дата создания
  readAt?: Date;        // Дата прочтения
}
```

### TemplateDto
```typescript
{
  code: string;         // Код шаблона
  subject: string;      // Тема
  template: string;     // Шаблон сообщения
  type: string;         // Тип (EMAIL/IN_APP/PUSH)
  isActive: boolean;    // Статус активности
}
```

## Особенности работы

1. **Типы уведомлений**:
   - EMAIL: Отправка на email
   - IN_APP: Уведомления в приложении
   - PUSH: Push-уведомления

2. **Шаблонизация**:
   - Поддерживает Handlebars синтаксис
   - Возможность использования вложенных объектов
   - HTML форматирование для email

3. **Очереди**:
   - Асинхронная отправка через RabbitMQ
   - Отложенная отправка уведомлений
   - Повторные попытки при ошибках